!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).CartItem={})}(this,function(t){"use strict";class CartItem extends HTMLElement{static#t=null;static#e=null;#s="ready";#i=!1;#n={};#a=null;static setTemplate(t){if("function"!=typeof t)throw new Error("Template must be a function");CartItem.#t=t}static setProcessingTemplate(t){if("function"!=typeof t)throw new Error("Processing template must be a function");CartItem.#e=t}static get observedAttributes(){return["state","key"]}attributeChangedCallback(t,e,s){e!==s&&"state"===t&&(this.#s=s||"ready")}constructor(t=null){super(),this.#a=t,this.#s=t?"appearing":this.getAttribute("state")||"ready",this.#n={click:this.#r.bind(this),change:this.#c.bind(this),transitionEnd:this.#o.bind(this)}}connectedCallback(){this.#a&&this.#h(),this.content=this.querySelector("cart-item-content"),this.processing=this.querySelector("cart-item-processing"),this.#m(),"appearing"===this.#s&&(this.setAttribute("state","appearing"),requestAnimationFrame(()=>{const t=this.scrollHeight;this.style.height=`${t}px`,setTimeout(()=>{this.setState("ready"),setTimeout(()=>{this.style.height=""},400)},50)}))}disconnectedCallback(){this.#l()}#m(){this.addEventListener("click",this.#n.click),this.addEventListener("change",this.#n.change),this.addEventListener("transitionend",this.#n.transitionEnd)}#l(){this.removeEventListener("click",this.#n.click),this.removeEventListener("change",this.#n.change),this.removeEventListener("transitionend",this.#n.transitionEnd)}get state(){return this.#s}get cartKey(){return this.getAttribute("key")}#r(t){t.target.closest("[data-action-remove-item]")&&(t.preventDefault(),this.#d())}#c(t){const e=t.target.closest("[data-cart-quantity]");e&&this.#u(e.value)}#o(t){"height"===t.propertyName&&this.#i&&this.remove()}#d(){this.dispatchEvent(new CustomEvent("cart-item:remove",{bubbles:!0,detail:{cartKey:this.cartKey,element:this}}))}#u(t){this.dispatchEvent(new CustomEvent("cart-item:quantity-change",{bubbles:!0,detail:{cartKey:this.cartKey,quantity:parseInt(t),element:this}}))}#h(){if(!this.#a||!CartItem.#t)return;const t=this.#a.key||this.#a.id;t&&this.setAttribute("key",t);const e=CartItem.#t(this.#a),s=CartItem.#e?CartItem.#e():'<div class="cart-item-loader"></div>';this.innerHTML=`\n      <cart-item-content>\n        ${e}\n      </cart-item-content>\n      <cart-item-processing>\n        ${s}\n      </cart-item-processing>\n    `}setData(t){this.#a=t,this.#h(),this.content=this.querySelector("cart-item-content"),this.processing=this.querySelector("cart-item-processing")}get itemData(){return this.#a}setState(t){["ready","processing","destroying","appearing"].includes(t)&&this.setAttribute("state",t)}destroyYourself(){if(this.#i)return;this.#i=!0;const t=this.offsetHeight;this.setState("destroying"),requestAnimationFrame(()=>{this.style.height=`${t}px`,this.offsetHeight;const e=getComputedStyle(this),s=e.getPropertyValue("--cart-item-destroying-duration")?.trim()||"400ms";this.style.transition=`height ${s} ease`,this.style.height="0px"})}}class CartItemContent extends HTMLElement{constructor(){super()}}class CartItemProcessing extends HTMLElement{constructor(){super()}}customElements.get("cart-item")||customElements.define("cart-item",CartItem),customElements.get("cart-item-content")||customElements.define("cart-item-content",CartItemContent),customElements.get("cart-item-processing")||customElements.define("cart-item-processing",CartItemProcessing),t.CartItem=CartItem,t.CartItemContent=CartItemContent,t.CartItemProcessing=CartItemProcessing});
