{"version":3,"file":"cart-item.cjs.js","sources":["../src/cart-item.js"],"sourcesContent":["import './cart-item.scss';\n\n/**\n * CartItem class that handles the functionality of a cart item component\n */\nclass CartItem extends HTMLElement {\n  // Private fields\n  #currentState = 'ready';\n  #isDestroying = false;\n  #handlers = {};\n\n  /**\n   * Define which attributes should be observed for changes\n   */\n  static get observedAttributes() {\n    return ['data-state', 'data-key'];\n  }\n\n  /**\n   * Called when observed attributes change\n   */\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (oldValue === newValue) return;\n\n    if (name === 'data-state') {\n      this.#currentState = newValue || 'ready';\n    }\n  }\n\n  constructor() {\n    super();\n\n    // Set initial state\n    this.#currentState = this.getAttribute('data-state') || 'ready';\n\n    // Bind event handlers\n    this.#handlers = {\n      click: this.#handleClick.bind(this),\n      change: this.#handleChange.bind(this),\n      transitionEnd: this.#handleTransitionEnd.bind(this),\n    };\n  }\n\n  connectedCallback() {\n    // Find child elements\n    this.content = this.querySelector('cart-item-content');\n    this.processing = this.querySelector('cart-item-processing');\n\n    // Attach event listeners\n    this.#attachListeners();\n  }\n\n  disconnectedCallback() {\n    // Cleanup event listeners\n    this.#detachListeners();\n  }\n\n  /**\n   * Attach event listeners\n   */\n  #attachListeners() {\n    this.addEventListener('click', this.#handlers.click);\n    this.addEventListener('change', this.#handlers.change);\n    this.addEventListener('transitionend', this.#handlers.transitionEnd);\n  }\n\n  /**\n   * Detach event listeners\n   */\n  #detachListeners() {\n    this.removeEventListener('click', this.#handlers.click);\n    this.removeEventListener('change', this.#handlers.change);\n    this.removeEventListener('transitionend', this.#handlers.transitionEnd);\n  }\n\n  /**\n   * Get the current state\n   */\n  get state() {\n    return this.#currentState;\n  }\n\n  /**\n   * Get the cart key for this item\n   */\n  get cartKey() {\n    return this.getAttribute('data-key');\n  }\n\n  /**\n   * Handle click events (for Remove buttons, etc.)\n   */\n  #handleClick(e) {\n    // Check if clicked element is a remove button\n    const removeButton = e.target.closest('[data-action=\"remove\"]');\n    if (removeButton) {\n      e.preventDefault();\n      this.#emitRemoveEvent();\n    }\n  }\n\n  /**\n   * Handle change events (for quantity inputs)\n   */\n  #handleChange(e) {\n    // Check if changed element is a quantity input\n    const quantityInput = e.target.closest('[data-cart-quantity]');\n    if (quantityInput) {\n      this.#emitQuantityChangeEvent(quantityInput.value);\n    }\n  }\n\n  /**\n   * Handle transition end events for destroy animation\n   */\n  #handleTransitionEnd(e) {\n    if (e.propertyName === 'height' && this.#isDestroying) {\n      // Remove from DOM after height animation completes\n      this.remove();\n    }\n  }\n\n  /**\n   * Emit remove event\n   */\n  #emitRemoveEvent() {\n    this.dispatchEvent(\n      new CustomEvent('cart-item:remove', {\n        bubbles: true,\n        detail: {\n          cartKey: this.cartKey,\n          element: this,\n        },\n      })\n    );\n  }\n\n  /**\n   * Emit quantity change event\n   */\n  #emitQuantityChangeEvent(quantity) {\n    this.dispatchEvent(\n      new CustomEvent('cart-item:quantity-change', {\n        bubbles: true,\n        detail: {\n          cartKey: this.cartKey,\n          quantity: parseInt(quantity),\n          element: this,\n        },\n      })\n    );\n  }\n\n  /**\n   * Set the state of the cart item\n   * @param {string} state - 'ready', 'processing', or 'destroying'\n   */\n  setState(state) {\n    if (['ready', 'processing', 'destroying'].includes(state)) {\n      this.setAttribute('data-state', state);\n    }\n  }\n\n  /**\n   * Destroy this cart item with animation\n   */\n  destroyYourself() {\n    if (this.#isDestroying) return; // Prevent multiple calls\n\n    this.#isDestroying = true;\n\n    // First set to destroying state for visual effects\n    this.setState('destroying');\n\n    // Get current height for animation\n    const currentHeight = this.offsetHeight;\n\n    // Force height to current value (removes auto)\n    this.style.height = `${currentHeight}px`;\n\n    // Trigger reflow to ensure height is set\n    this.offsetHeight;\n\n    // Get the destroying duration from CSS custom property\n    const computedStyle = getComputedStyle(this);\n    const destroyingDuration =\n      computedStyle.getPropertyValue('--cart-item-destroying-duration') || '400ms';\n\n    // Add transition and animate to 0 height\n    this.style.transition = `all ${destroyingDuration} ease`;\n    this.style.height = '0px';\n\n    // The actual removal happens in #handleTransitionEnd\n  }\n}\n\n/**\n * Supporting component classes for cart item\n */\nclass CartItemContent extends HTMLElement {\n  constructor() {\n    super();\n  }\n}\n\nclass CartItemProcessing extends HTMLElement {\n  constructor() {\n    super();\n  }\n}\n\n// Define custom elements\ncustomElements.define('cart-item', CartItem);\ncustomElements.define('cart-item-content', CartItemContent);\ncustomElements.define('cart-item-processing', CartItemProcessing);\n\n// Export components for external use\nexport { CartItem, CartItemContent, CartItemProcessing };\n"],"names":[],"mappings":"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"}